import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as s,o as a,b as e}from"./app-CiIr8rgP.js";const l={},t=e(`<h2 id="_1-el-dialog组件与v-if" tabindex="-1"><a class="header-anchor" href="#_1-el-dialog组件与v-if"><span>1. <code>el-dialog</code>组件与<code>v-if</code></span></a></h2><h3 id="_1-1-问题描述" tabindex="-1"><a class="header-anchor" href="#_1-1-问题描述"><span>1.1 问题描述：</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">el-dialog</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    title</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;编辑数据集&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    append-to-body</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    destroy-on-close</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">    :visible.sync=&quot;showEdit&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> &gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">add-datasets</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">  @closeBaseDialog=&quot;handleClose&quot;&gt;&lt;/add-datasets&gt;</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">&lt;/el-dialog&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>    在这里不添加<code>v-if</code>属性时，那么第一次点击弹出add-datasets这个组件是会打印<code>mounted</code>生命周期函数的内容，但是取消之后还会打印一次.<br>     第二次再点击弹出<code>add-datasets</code>不会打印<code>mounted</code>生命周期函数的内容但取消（关闭el-dialog）之后之后还会打印一次，后续第三次...都是这样跟第二次一样效果。</p><h3 id="_1-2-问题的原因" tabindex="-1"><a class="header-anchor" href="#_1-2-问题的原因"><span>1.2 问题的原因：</span></a></h3><ol><li><p><strong><code>destroy-on-close</code></strong>：当你设置了 <code>destroy-on-close</code> 时，<code>el-dialog</code> 会在<strong>对话框关闭时销毁其内部内容</strong>。由于没有设置 <code>v-if</code> 属性，第一次点击时，<code>add-datasets</code> 组件会加载并触发 <code>mounted</code> 生命周期。在关闭 <code>el-dialog</code> 时，<code>add-datasets</code> 组件被销毁，而 <code>destroy-on-close</code> 会在每次关闭时触发销毁机制。因此，当关闭对话框时，组件被销毁，接下来下一次点击对话框时，组件不会再次触发 <code>mounted</code> 生命周期（因为 <code>v-if</code> 控制不在）.</p></li><li><p><strong>第二次不触发 <code>mounted</code></strong>：由于 <code>v-if</code> 没有控制组件的显示/隐藏，<code>add-datasets</code> 组件不会在后续的对话框打开时重新挂载，因此不会再次触发 <code>mounted</code> 生命周期。</p></li></ol><h3 id="_1-2-为什么关闭el-dialog组件内嵌add-datasets组件的会被重新挂载" tabindex="-1"><a class="header-anchor" href="#_1-2-为什么关闭el-dialog组件内嵌add-datasets组件的会被重新挂载"><span>1.2 为什么关闭<code>el-dialog</code>组件内嵌add-datasets组件的会被重新挂载？</span></a></h3><ol><li>当 <code>destroy-on-close </code>为 <code>true</code> 时，关闭对话框会销毁其内容（即 <code>add-datasets</code> 组件），但如果 <code>v-if</code> 或者其他条件渲染逻辑没有控制组件的显示与销毁，可能会导致在对话框关闭时，组件被销毁但随后又立即重新挂载。</li></ol><h3 id="解决方案" tabindex="-1"><a class="header-anchor" href="#解决方案"><span>解决方案：</span></a></h3><p>要避免这种情况，你可以通过 <code>v-if</code> 来确保在每次弹出时，<code>add-datasets</code> 组件都被销毁并重新创建，从而触发其 <code>mounted</code> 生命周期。</p><p>可以调整代码如下：</p><div class="language-vue line-numbers-mode" data-highlighter="shiki" data-ext="vue" data-title="vue" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">el-dialog</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;">  title</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;编辑数据集&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  v-if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">showEdit</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;">  width</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;800px&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;">  append-to-body</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;">  custom-class</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;cus-dialog-ent&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;">  destroy-on-close</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;">visible</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;">sync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">showEdit</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;">close-on-click-modal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;">close-on-press-escape</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  &lt;add-datasets v-if=&quot;showEdit&quot;  @closeBaseDialog=&quot;handleClose&quot;&gt;&lt;/add-datasets&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">el-dialog</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="解释" tabindex="-1"><a class="header-anchor" href="#解释"><span>解释：</span></a></h3><ol><li><p>通过 <code>v-if=&quot;showEdit&quot;</code> 控制 <code>add-datasets</code> 组件的显示与隐藏。每次对话框弹出时，<code>add-datasets</code> 组件会被重新渲染，从而触发其 <code>mounted</code> 生命周期。</p></li><li><p><code>destroy-on-close</code> 仍然会在关闭时销毁对话框内容，确保内存不会泄露。</p></li></ol><p>通过这个方式，每次打开对话框时，<code>add-datasets</code> 都会触发 <code>mounted</code> 生命周期。</p>`,15),n=[t];function d(h,o){return a(),s("div",null,n)}const c=i(l,[["render",d],["__file","03.el-dialogAndv-if.html.vue"]]),r=JSON.parse('{"path":"/element-ui/03.el-dialogAndv-if.html","title":"03.el-dialog有无-if区别","lang":"zh-CN","frontmatter":{"lang":"zh-CN","title":"03.el-dialog有无-if区别","description":"03_el-dialog有无-if区别"},"headers":[{"level":2,"title":"1. el-dialog组件与v-if","slug":"_1-el-dialog组件与v-if","link":"#_1-el-dialog组件与v-if","children":[{"level":3,"title":"1.1 问题描述：","slug":"_1-1-问题描述","link":"#_1-1-问题描述","children":[]},{"level":3,"title":"1.2 问题的原因：","slug":"_1-2-问题的原因","link":"#_1-2-问题的原因","children":[]},{"level":3,"title":"1.2 为什么关闭el-dialog组件内嵌add-datasets组件的会被重新挂载？","slug":"_1-2-为什么关闭el-dialog组件内嵌add-datasets组件的会被重新挂载","link":"#_1-2-为什么关闭el-dialog组件内嵌add-datasets组件的会被重新挂载","children":[]},{"level":3,"title":"解决方案：","slug":"解决方案","link":"#解决方案","children":[]},{"level":3,"title":"解释：","slug":"解释","link":"#解释","children":[]}]}],"git":{"createdTime":1725723996000,"updatedTime":1731211300000,"contributors":[{"name":"liznlin","email":"3215144676@qq.com","commits":1}]},"readingTime":{"minutes":2.28,"words":685},"filePathRelative":"element-ui/03.el-dialogAndv-if.md","localizedDate":"2024年9月7日"}');export{c as comp,r as data};
